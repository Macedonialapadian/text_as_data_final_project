plot_data$Metric <- factor(plot_data$Metric, levels = c("Comments", "Retweets", "Likes", "Views"))
# 3. Create the Plot
ggplot(plot_data, aes(x = Pct_Change, y = Metric)) +
# Add the vertical dashed line at 0 (0% change = No Effect)
geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
# Add the points and error bars
geom_pointrange(aes(xmin = Conf_Low_Pct, xmax = Conf_High_Pct),
color = "#2E86C1", size = 0.8) +
# Styling
theme_bw() +
labs(
title = "Effect of Emotional Intensity on Audience Engagement",
subtitle = "Percentage increase in engagement for every 1-unit increase in intensity score",
x = "Percentage Change in Engagement (%)",
y = NULL
) +
theme(
axis.text.y = element_text(size = 11, face = "bold"),
axis.text.x = element_text(size = 10),
panel.grid.major.y = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
table(dta$party)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black", "Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
model_b1 <- lm(log(likes + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b1)
model_b2 <- lm(log(comments + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b2)
model_b3 <- lm(log(retweets + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b3)
model_b4 <- lm(log(views + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b4)
summary(model_b1)
dta_dem<-dta%>%
filter(party=="Democratic")
model_c1 <- lm(log(likes + 1) ~ predicted_bws_score + gender + race, data =
dta_dem)
summary(model_c1)
dta_goa<-dta%>%
filter(party=="Republican")
model_c2 <- lm(log(likes + 1) ~ predicted_bws_score + gender + race, data =
dta_goa)
summary(model_c2)
dta %>%
mutate(category = cut(
likes,
breaks = c(-Inf, 10, 100, 1000, 10000,100000,Inf),
labels = c("0-10", "11-100", "101-1000","1001-10000","10001-100000", ">100000"))) %>%
ggplot(aes(x = likes)) +
geom_histogram(fill = "#69b3a2", color = "white", bins = 30) +
theme_minimal() +
facet_wrap(~category, scales = "free") +
labs(title = "Distribution of Likes")
table(dta$party)
tabl(dta$race)
table(dta$race)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
table(dta$race)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
table1(dta$race)
table(dta$race)
colnames(dta)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
# dta <- dta %>%
#   mutate(
#     race = case_when(
#       race == "White" ~ "White",
#       race == "Black" ~ "Black",
#       TRUE ~ "Other"
#     ),
#     race = factor(race, levels = c("White", "Black", "Other")),
#
#     party = case_when(
#       party == "Democratic" ~ "Democratic",
#       party == "Republican" ~ "Republican",
#       TRUE ~ "Other"
#     ),
#     party = factor(party, levels = c("Democratic", "Republican", "Other"))
#   )
table(dta$race)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
table(dta$race)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black", "Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
table(dta$race)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
table(dta$race)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
model_b1 <- lm(log(likes + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b1)
model_b2 <- lm(log(comments + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b2)
model_b3 <- lm(log(retweets + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b3)
model_b4 <- lm(log(views + 1) ~ predicted_bws_score + party + gender + race, data =
dta)
summary(model_b4)
summary(model_b1)
dta_dem<-dta%>%
filter(party=="Democratic")
model_c1 <- lm(log(likes + 1) ~ predicted_bws_score + gender + race, data =
dta_dem)
summary(model_c1)
dta_goa<-dta%>%
filter(party=="Republican")
model_c2 <- lm(log(likes + 1) ~ predicted_bws_score + gender + race, data =
dta_goa)
summary(model_c2)
dta %>%
mutate(category = cut(
likes,
breaks = c(-Inf, 10, 100, 1000, 10000,100000,Inf),
labels = c("0-10", "11-100", "101-1000","1001-10000","10001-100000", ">100000"))) %>%
ggplot(aes(x = likes)) +
geom_histogram(fill = "#69b3a2", color = "white", bins = 30) +
theme_minimal() +
facet_wrap(~category, scales = "free") +
labs(title = "Distribution of Likes")
library(ggplot2)
library(dplyr)
# 1. Update the dataframe with NEW values from your latest regression outputs
plot_data <- data.frame(
Metric = c("Likes", "Comments", "Retweets", "Views"),
# These are the coefficients for 'predicted_bws_score' from your 4 new models
Estimate = c(0.0367014, 0.0254447, 0.0359781, 0.0452592),
# These are the standard errors for 'predicted_bws_score'
Std_Error = c(0.0009673, 0.0007186, 0.0008727, 0.0009631)
) %>%
mutate(
# Calculate 95% Confidence Intervals on the log scale first
Conf_Low_Log = Estimate - (1.96 * Std_Error),
Conf_High_Log = Estimate + (1.96 * Std_Error),
# CONVERT TO PERCENTAGE CHANGE
# Formula: (exp(coefficient) - 1) * 100
Pct_Change = (exp(Estimate) - 1) * 100,
Conf_Low_Pct = (exp(Conf_Low_Log) - 1) * 100,
Conf_High_Pct = (exp(Conf_High_Log) - 1) * 100
)
# 2. Define the order of the Y-axis (Sorted by magnitude usually looks best)
plot_data$Metric <- factor(plot_data$Metric, levels = c("Comments", "Retweets", "Likes", "Views"))
# 3. Create the Plot
ggplot(plot_data, aes(x = Pct_Change, y = Metric)) +
# Add the vertical dashed line at 0 (0% change = No Effect)
geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
# Add the points and error bars
geom_pointrange(aes(xmin = Conf_Low_Pct, xmax = Conf_High_Pct),
color = "#2E86C1", size = 0.8) +
# Styling
theme_bw() +
labs(
title = "Effect of Emotional Intensity on Audience Engagement",
subtitle = "Percentage increase in engagement for every 1-unit increase in intensity score",
x = "Percentage Change in Engagement (%)",
y = NULL
) +
theme(
axis.text.y = element_text(size = 11, face = "bold"),
axis.text.x = element_text(size = 10),
panel.grid.major.y = element_line(color = "gray90"),
panel.grid.minor = element_blank()
)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
model_a<-lm(predicted_bws_score~gender+party,data=dta)
summary(model_a)
vif(model_a)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
dta %>% filter(party == "Other")
table(dta$Other)
table(dta$party)
library(pacman)
p_load(tidyverse,ggplot2,car)
dta <- read_csv("data/cleaned/the_dataset.csv",
col_types = cols(url = col_character()))
url_officer <- read_csv("data/cleaned/urls_official_id.csv",
col_types = cols(url = col_character()))
officer_data<-read_csv("data/raw/official_data.csv")
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
# origianl score is 0-1, rescale it to 1-100
dta$predicted_bws_score<-dta$predicted_bws_score*100
dta<-left_join(dta, officer_data,by="official_id")
# there are data that have problematic date, due to being retweeted but lost the retweet time. remove them.
dta$month<-month(dta$datetime)
dta <- dta %>%
filter(!month %in% c(1, 2, 3, 4))
dta$year<-year(dta$datetime)
dta <- dta %>%
filter(year==2024)
dta <- dta %>%
mutate(
race = case_when(
race == "White" ~ "White",
race == "Black" ~ "Black",
race == "Latino" ~ "Latino",
race == "Asian American" ~ "Asian American",
TRUE ~ "Other"
),
race = factor(race, levels = c("White", "Black","Latino","Asian American","Other")),
party = case_when(
party == "Democratic" ~ "Democratic",
party == "Republican" ~ "Republican",
TRUE ~ "Other"
),
party = factor(party, levels = c("Democratic", "Republican", "Other"))
)
